# Excel Import/Export System Guide

## Overview

The SolNet Management System includes a comprehensive Excel import/export system that allows you to:

- **Export** existing data to Excel files for backup, analysis, or migration
- **Import** data from Excel files to bulk-load information into the system
- **Download templates** with the correct format and example data
- **Validate data** during import to ensure data integrity

## Supported Entities

### 1. Customers

**Description**: Import/export customer information including contact details and notes

**Required Fields**:

- `name` - Customer full name
- `phone` - Phone number (must be unique)

**Optional Fields**:

- `email` - Email address
- `address` - Physical address
- `notes` - Additional notes
- `registrationDate` - Date when customer first attended the shop (YYYY-MM-DD format)

**System-Generated Fields** (do not include in import):

- `id` - Unique customer identifier
- `locationId` - Location assignment
- `createdAt` - Creation timestamp
- `updatedAt` - Last update timestamp

**Import Tips**:

- Phone numbers must be unique across all customers
- Email addresses are optional but recommended for notifications
- Registration date should be the date when customer first attended the shop
- If registration date is not provided, current date will be used
- System will automatically assign location based on your account

### 2. Inventory

**Description**: Import/export inventory items with pricing and stock management

**Required Fields**:

- `name` - Item name
- `sku` - Stock Keeping Unit (must be unique)
- `salePrice` - Selling price
- `quantity` - Current stock quantity

**Optional Fields**:

- `description` - Item description
- `category` - Item category
- `purchasePrice` - Cost price
- `minStockLevel` - Minimum stock level (default: 10)
- `reorderPoint` - Reorder point (default: 15)
- `reorderQuantity` - Reorder quantity (default: 50)
- `leadTimeDays` - Supplier lead time in days
- `supplier` - Supplier name
- `barcode` - Barcode

**System-Generated Fields** (do not include in import):

- `id` - Unique inventory item identifier
- `locationId` - Location assignment
- `isActive` - Active status
- `lastRestocked` - Last restock date
- `predictedStockout` - Predicted stockout date
- `avgDailySales` - Average daily sales
- `createdAt` - Creation timestamp
- `updatedAt` - Last update timestamp

**Import Tips**:

- SKU must be unique across all inventory items
- Sale price is required and must be greater than 0
- System will automatically calculate stock predictions
- Use the template to ensure correct data format

### 3. Device Registration

**Description**: Import/export device repair registrations and service records

**Required Fields**:

- `customerId` - Customer UUID (must exist in system)
- `problemDescription` - Description of the problem

**Optional Fields**:

- `deviceTypeId` - Device type UUID
- `brandId` - Brand UUID
- `modelId` - Model UUID
- `serialNumber` - Device serial number
- `serviceTypeId` - Service type UUID
- `status` - Device status (default: registered)
- `priority` - Priority level (default: normal)
- `estimatedCompletionDate` - Estimated completion date (YYYY-MM-DD)
- `technicianNotes` - Internal technician notes
- `customerNotes` - Customer notes
- `totalCost` - Total repair cost
- `paymentStatus` - Payment status (default: pending)

**System-Generated Fields** (do not include in import):

- `id` - Unique device identifier
- `receiptNumber` - Receipt number
- `locationId` - Location assignment
- `createdBy` - User who created the record
- `assignedTo` - Assigned technician
- `feedbackRequested` - Feedback request status
- `feedbackSubmitted` - Feedback submission status
- `createdAt` - Creation timestamp
- `updatedAt` - Last update timestamp

**Status Options**:

- `registered` - Device registered for repair
- `diagnosed` - Problem diagnosed
- `in_progress` - Repair in progress
- `waiting_parts` - Waiting for parts
- `completed` - Repair completed
- `ready_for_pickup` - Ready for customer pickup
- `delivered` - Delivered to customer
- `cancelled` - Repair cancelled

**Priority Options**:

- `normal` - Normal priority
- `high` - High priority
- `urgent` - Urgent priority

**Payment Status Options**:

- `pending` - Payment pending
- `paid` - Payment received
- `partial` - Partial payment
- `refunded` - Payment refunded

**Import Tips**:

- Customer ID must reference an existing customer in the system
- Device type, brand, and model IDs must exist in service management
- Receipt numbers are automatically generated by the system

### 4. Service Management

**Description**: Import/export service types, brands, models, accessories, and device types

**Multi-Sheet Structure**:
The service management export/import uses multiple sheets in a single Excel file:

#### Service Types Sheet

**Required Fields**:

- `name` - Service name

**Optional Fields**:

- `description` - Service description
- `category` - Service category (default: General)
- `estimatedDuration` - Estimated duration in minutes
- `basePrice` - Base price for the service
- `isPublic` - Show on public page (default: true)
- `features` - JSON array of features (e.g., `["New screen", "Warranty", "Testing"]`)
- `requirements` - Service requirements
- `warranty` - Warranty information
- `imageUrl` - Image URL
- `isActive` - Active status (default: true)
- `sortOrder` - Display order (default: 0)

#### Brands Sheet

**Required Fields**:

- `name` - Brand name

**Optional Fields**:

- `description` - Brand description
- `website` - Brand website URL
- `isActive` - Active status (default: true)

#### Device Types Sheet

**Required Fields**:

- `name` - Device type name

**Optional Fields**:

- `description` - Device type description
- `isActive` - Active status (default: true)

#### Models Sheet

**Required Fields**:

- `name` - Model name
- `brandId` - Brand UUID (must exist)
- `deviceTypeId` - Device type UUID (must exist)

**Optional Fields**:

- `description` - Model description
- `specifications` - Technical specifications
- `releaseYear` - Release year
- `isActive` - Active status (default: true)

#### Accessories Sheet

**Required Fields**:

- `name` - Accessory name
- `sku` - Stock Keeping Unit (must be unique)
- `salePrice` - Selling price

**Optional Fields**:

- `description` - Accessory description
- `category` - Category (default: General)
- `brand` - Brand name
- `model` - Model name
- `purchasePrice` - Purchase price
- `quantity` - Stock quantity (default: 0)
- `minStockLevel` - Minimum stock level (default: 5)
- `reorderPoint` - Reorder point (default: 10)
- `reorderQuantity` - Reorder quantity (default: 20)
- `isPublic` - Show on public page (default: true)
- `isActive` - Active status (default: true)
- `sortOrder` - Display order (default: 0)
- `imageUrl` - Image URL
- `specifications` - JSON object of specifications (e.g., `{"length": "1m", "power": "3A"}`)
- `compatibility` - JSON array of compatible devices (e.g., `["iPhone", "Android", "Laptop"]`)
- `warranty` - Warranty information

**Import Order** (Important!):

1. **Device Types** - Import first as they are referenced by models
2. **Brands** - Import second as they are referenced by models
3. **Models** - Import third (requires Brand ID and Device Type ID)
4. **Service Types** - Import fourth
5. **Accessories** - Import last

**Import Tips**:

- Import order matters: Device Types → Brands → Models → Service Types → Accessories
- Models require existing Brand ID and Device Type ID
- Accessories require unique SKU
- Service types can include JSON arrays for features and requirements
- Use the multi-sheet template for proper organization

## How to Use the Import/Export System

### Accessing the System

1. Navigate to **Import/Export** in the admin sidebar
2. Select the entity you want to work with from the tabs
3. Use the provided controls for export, import, and template download

### Exporting Data

1. Click the **"Export XLSX"** button
2. The system will generate an Excel file with all current data
3. The file will automatically download to your computer
4. File naming: `{entity-name}.xlsx`

### Importing Data

1. **Download the template** first to ensure correct format
2. Fill in your data following the template structure
3. **Do not include system-generated fields** (IDs, timestamps, etc.)
4. Click **"Import XLSX"** and select your file
5. Review the import results for any errors or warnings
6. The system will show how many records were successfully imported

### Downloading Templates

1. Click the **"Download Template"** button
2. The system will generate a template with:
   - Correct column headers
   - Example data showing the expected format
   - Proper data types and validation rules
3. Use this template as a starting point for your data

## Best Practices

### Before Importing

1. **Backup your data** - Always backup before large imports
2. **Use templates** - Download and use the provided templates
3. **Validate data** - Check your data for:
   - Required fields are filled
   - Unique constraints (phone numbers, SKUs, etc.)
   - Correct data types (dates, numbers, etc.)
   - Valid references (customer IDs, brand IDs, etc.)

### During Import

1. **Start small** - Test with a few records first
2. **Check results** - Review import results for errors
3. **Fix issues** - Address any validation errors before proceeding
4. **Monitor progress** - Large imports may take several minutes

### After Import

1. **Verify data** - Check that imported data appears correctly
2. **Test functionality** - Ensure imported records work as expected
3. **Update references** - If importing related data, ensure references are correct

## Common Issues and Solutions

### Import Errors

- **"Required field missing"** - Ensure all required fields are filled
- **"Unique constraint violation"** - Check for duplicate values in unique fields
- **"Invalid reference"** - Ensure referenced IDs exist in the system
- **"Invalid data type"** - Check that dates, numbers, and other fields are in correct format

### Performance Issues

- **Large imports** - Break large imports into smaller batches
- **Slow processing** - Close other applications to free up system resources
- **Timeout errors** - Contact support for very large datasets

### Data Validation

- **Phone numbers** - Ensure consistent format (e.g., 1234567890)
- **Email addresses** - Use valid email format (user@domain.com)
- **Dates** - Use YYYY-MM-DD format
- **Numbers** - Use decimal point (not comma) for decimal numbers
- **JSON fields** - Ensure valid JSON syntax for complex fields

## Security and Permissions

### Access Control

- **Admin only** - Import/export functionality is restricted to admin users
- **Location-based** - Data is filtered by user's assigned location
- **Audit trail** - All imports are logged with user and timestamp

### Data Protection

- **Validation** - All imported data is validated before insertion
- **Sanitization** - Data is cleaned to prevent injection attacks
- **Backup** - System maintains backups of critical data

## Support and Troubleshooting

### Getting Help

1. **Check the template** - Use the provided templates for correct format
2. **Review error messages** - Error messages provide specific guidance
3. **Test with sample data** - Try importing a few records first
4. **Contact support** - For complex issues or large datasets

### Common Questions

- **Q: Can I import data from other systems?**
  A: Yes, as long as you format the data according to our templates

- **Q: What happens if import fails?**
  A: The system will show specific error messages and no data will be imported

- **Q: Can I update existing records?**
  A: The current system creates new records. Updates require manual editing or system modification

- **Q: How do I handle relationships between entities?**
  A: Import in the correct order (e.g., customers before devices) and use existing IDs for references

## File Format Specifications

### Supported Formats

- **Excel (.xlsx)** - Primary format, recommended
- **Excel (.xls)** - Legacy format, supported but not recommended

### File Size Limits

- **Maximum file size**: 10MB
- **Recommended**: Keep files under 5MB for best performance
- **Large datasets**: Split into multiple files if needed

### Column Specifications

- **Headers**: Must match template exactly (case-sensitive)
- **Data types**: Follow template examples for correct formatting
- **Empty cells**: Leave empty for optional fields, use appropriate defaults for required fields

This comprehensive import/export system provides a robust solution for data management while maintaining data integrity and system security.
